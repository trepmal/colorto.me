jQuery(document).ready(function($){$('#colors').sortable({items:'div.col',placeholder:'col colph',forcePlaceholderSize:true,stop:function(event,ui){$('#colors').css('backgroundColor',$('div.col:last').css('backgroundColor'));updateURL();}});getURL=function(){url='/';$('input').each(function(index){url+=$(this).val()+'/';});$('#save').attr('href',url);return url;}
getimgURL=function(){url=getURL();$('#image').attr('href','/png/500x500'+url);return url;}
updateURL=function(){var stateObj={foo:"bar"};history.pushState(stateObj,"Colors",getURL());getimgURL();}
getURL();$('.col input').numeric({allow:'abcdef'});$('.col input').live('keyup',function(){updateURL();var color=$(this).val();if(color.length==3||color.length==6){if($(this).parent('p').parent('div.col').index()===$('div.col').length){$('#colors').animate({backgroundColor:'#'+color},500);}
$(this).parent().parent('div').animate({backgroundColor:'#'+color},500);}});$('#add').click(function(){last=$('.col:last');html=last.html();style=last.attr('style');last.after('<div class="col" style="'+style+'">'+html+'</div>');total=$('.col').length;var width=100/total;$('.col').each(function(){$(this).width(width+'%');});updateURL();return false;});$('.del').click(function(){$(this).parent('p').parent('div').remove();total=$('.col').length;var width=100/total;$('.col').each(function(){$(this).width(width+'%');});updateURL();return false;});$('#gobtn').click(function(){$('#colorform').submit();return false;});});